"use strict";(self["webpackChunkkeydrop"]=self["webpackChunkkeydrop"]||[]).push([[241],{7450:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var o=s(3673),r=s(2323);const a={key:0},i=(0,o._)("div",{class:"counter-wrapper"},[(0,o._)("div",{class:"counter"}," THE END ")],-1),l=[i],n={key:1},d={class:"top-controls"},c=(0,o._)("div",{class:"progressbar-title"},"Time: ",-1),h={class:"progressbar-wrapper col",style:{}},m={class:"score"},u=(0,o._)("div",{class:"score-label"},"Score:",-1),p={class:"score-result"},g={class:"score-positive"},f=(0,o.Uk)(" ("),w={class:"score-negative"},v=(0,o.Uk)(") "),I={key:0,class:"counter-wrapper"},k={key:0,class:"counter"},y={key:1,class:"counter"},_={key:1,class:"words",style:{position:"relative"}};function b(e,t,s,i,b,x){const C=(0,o.up)("q-page-container"),D=(0,o.up)("Keyboard"),K=(0,o.up)("Keyboard2"),W=(0,o.up)("NormalKeyboard"),T=(0,o.up)("q-toolbar-title"),q=(0,o.up)("q-toolbar"),F=(0,o.up)("q-footer"),G=(0,o.up)("q-layout");return(0,o.wg)(),(0,o.j4)(G,{view:"hHh lpR fFf"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{class:"q-px-md"},{default:(0,o.w5)((()=>[e.gameFinished?((0,o.wg)(),(0,o.iD)("div",a,l)):((0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",d,[c,(0,o._)("div",h,[(0,o._)("div",{class:(0,r.C_)(["progressbar",{complete:e.counter<0}])},null,2)]),(0,o._)("div",m,[u,(0,o._)("div",p,[(0,o._)("span",g,"+"+(0,r.zw)(e.correct_characters),1),f,(0,o._)("span",w,"-"+(0,r.zw)(e.failed_characters),1),v])])]),e.counter>=0?((0,o.wg)(),(0,o.iD)("div",I,[e.counter>1?((0,o.wg)(),(0,o.iD)("div",k," Ready ")):(0,o.kq)("",!0),e.counter>=0&&e.counter<=1?((0,o.wg)(),(0,o.iD)("div",y," GO! ")):(0,o.kq)("",!0)])):(0,o.kq)("",!0),e.counter<0?((0,o.wg)(),(0,o.iD)("div",_,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.items,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:(0,r.C_)(["word",{normal:t.top>0&&t.top<=50,warning:t.top>50&&t.top<=75,danger:t.top>75&&t.top<=91,delete:t.top>91}]),style:(0,r.j5)([t.left<=50?{top:t.top/100*e.viewportHeight+"px",left:t.left+"%"}:{top:t.top/100*e.viewportHeight+"px",right:100-t.left+"%"}])},(0,r.zw)(t.word),7)))),128))])):(0,o.kq)("",!0)]))])),_:1}),(0,o.Wm)(F,{class:"footer"},{default:(0,o.w5)((()=>[(0,o.Wm)(q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>["flexi"==e.gamemode?((0,o.wg)(),(0,o.j4)(D,{key:0,modelValue:e.text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.text=t),onKeypressed:t[1]||(t[1]=t=>e.logKey(t)),onWordpressed:t[2]||(t[2]=t=>e.logWord(t))},null,8,["modelValue"])):"flexi2"==e.gamemode?((0,o.wg)(),(0,o.j4)(K,{key:1,modelValue:e.text,"onUpdate:modelValue":t[3]||(t[3]=t=>e.text=t),onKeypressed:t[4]||(t[4]=t=>e.logKey(t)),onWordpressed:t[5]||(t[5]=t=>e.logWord(t))},null,8,["modelValue"])):((0,o.wg)(),(0,o.j4)(W,{key:2,modelValue:e.text,"onUpdate:modelValue":t[6]||(t[6]=t=>e.text=t),onKeypressed:t[7]||(t[7]=t=>e.logKey(t)),onWordpressed:t[8]||(t[8]=t=>e.logWord(t))},null,8,["modelValue"]))])),_:1})])),_:1})])),_:1})])),_:1})}s(71),s(3985);var x=s(688),C=s(5827),D=s(3054);s(52);const K=(0,o.aZ)({name:"MainLayout",components:{Keyboard:x.Z,Keyboard2:C.Z,NormalKeyboard:D.Z},setup(){return{}},data(){return{text:"",addItemIntervalTime:1500,addItemInterval:void 0,checkIntervalTime:100,checkInterval:void 0,fallingIntervalTime:800,fallingInterval:void 0,fallingOffset:5,gametime:12e4,lastId:0,counter:3,startGameInterval:void 0,words:[],items:[],correct_characters:0,failed_characters:0,all_words:[],gameFinished:!1,starttime:0,gamemode:void 0,backspaceCounter:0,delwordCounter:0}},computed:{viewportHeight:function(){return this.$q.screen.height-this.getFooterSize()}},deactivated(){},unmounted(){this.endGame()},created(){var e;this.gamemode=null!==(e=this.$route.params.mode)&&void 0!==e?e:"flexi",this.words=JSON.parse(localStorage.getItem("words")),this.counter=3,this.lastId=0,this.gameFinished=!1,this.backspaceCounter=0,this.delwordCounter=0,this.startGameInterval=setInterval((()=>{this.counter--,this.counter<0&&(clearInterval(this.startGameInterval),this.startGame())}),1e3)},mounted(){},methods:{startGame:function(){this.starttime=Date.now(),this.refreshItems(),this.fallingInterval=setInterval(this.refreshItems,this.fallingIntervalTime),this.checkItems(),this.checkInterval=setInterval(this.checkItems,this.checkIntervalTime),this.addItem(),setInterval(this.addItem,this.addItemIntervalTime)},endGame:function(){if(0==this.gameFinished){console.log("The End"),this.items=[],clearInterval(this.fallingInterval),clearInterval(this.checkInterval),clearInterval(this.addItemInterval);let e=localStorage.getItem("games");e=void 0==e?[]:JSON.parse(e),e.push({mode:this.gamemode,starttime:this.starttime,endtime:Date.now(),allWords:Object.assign([],this.all_words),backspaceCounter:this.backspaceCounter,delwordCounter:this.delwordCounter}),localStorage.setItem("games",JSON.stringify(e)),this.gameFinished=!0,setTimeout((()=>{this.$router.push("/")}),2e3)}},getFooterSize:function(){return document.getElementsByClassName("q-footer")[0].getBoundingClientRect().height},logKey:function(e){"backspace"==e.original_key&&this.backspaceCounter++,console.log(this.backspaceCounter)},logWord:function(e){this.delwordCounter++},getRandomWord:function(){let e=Math.random();for(let t=0;t<this.words.probs.length;t++)if(this.words.probs[t]>e)return this.words.words[t]},addItem:function(){let e=this.getRandomWord(),t=Math.floor(100*Math.random());this.items.push({id:this.lastId++,word:e,starttime:Date.now(),top:-1,left:t})},checkItem:function(e){return this.text==e.word?(this.text="",{status:"done"}):e.top>95?{status:"timeout"}:{status:"pending"}},checkItems:function(){let e=[];for(let t of this.items){let s=this.checkItem(t);"done"==s.status?(this.all_words.push({word:t.word,top:t.top,correct:!0,starttime:t.starttime,endtime:Date.now()}),this.correct_characters+=t.word.length,e.push(t.id)):"timeout"==s.status&&(this.all_words.push({word:t.word,top:t.top,correct:!1,starttime:t.starttime,endtime:Date.now()}),this.failed_characters+=t.word.length,e.push(t.id))}for(let t of e)for(let e=0;e<this.items.length;e++)if(this.items[e].id==t){console.log(`Remove: ${this.items[e].id}`),this.items.splice(e,1);break}(this.text.includes(" ")||this.text.includes("\n"))&&(this.text="")},refreshItem:function(e){e.top+=this.fallingOffset},refreshItems:function(){Date.now()-this.starttime>=this.gametime&&this.endGame();for(let e of this.items)this.refreshItem(e)}}});var W=s(3066),T=s(2652),q=s(1762),F=s(9570),G=s(3747),S=s(7518),V=s.n(S);K.render=b;const Z=K;V()(K,"components",{QLayout:W.Z,QPageContainer:T.Z,QFooter:q.Z,QToolbar:F.Z,QToolbarTitle:G.Z})}}]);