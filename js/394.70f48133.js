"use strict";(self["webpackChunkkeydrop"]=self["webpackChunkkeydrop"]||[]).push([[394],{2394:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var n=s(3673);const r={key:0},o=(0,n._)("div",{class:"counter-wrapper"},[(0,n._)("div",{class:"counter"}," THE END ")],-1),i=[o],a={key:1},l={class:"top-controls"},c={class:"absolute-full flex flex-center"},d={class:"absolute-full flex flex-center"},h={key:0,class:"counter-wrapper"},u={key:0,class:"counter"},m={key:1,class:"counter"},p={key:2},g=(0,n._)("div",{class:"is-error"},[(0,n._)("div",{class:"counter",style:{color:"red"}}," ! ")],-1),y=[g];function f(e,t,s,o,g,f){const v=(0,n.up)("q-badge"),T=(0,n.up)("q-linear-progress"),w=(0,n.up)("q-card-section"),b=(0,n.up)("q-card"),S=(0,n.up)("q-page-container"),x=(0,n.up)("KeydropKeyboard"),k=(0,n.up)("NormalKeyboard"),D=(0,n.up)("q-toolbar-title"),C=(0,n.up)("q-toolbar"),I=(0,n.up)("q-footer"),K=(0,n.up)("q-layout");return(0,n.wg)(),(0,n.j4)(K,{view:"hHh lpR fFf"},{default:(0,n.w5)((()=>[(0,n.Wm)(S,{class:"q-px-md"},{default:(0,n.w5)((()=>[e.gameFinished?((0,n.wg)(),(0,n.iD)("div",r,i)):((0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("div",l,[(0,n.Wm)(T,{size:"30px",value:e.testProgress,color:"accent",class:"q-mt-sm"},{default:(0,n.w5)((()=>[(0,n._)("div",c,[(0,n.Wm)(v,{color:"white","text-color":"accent",label:e.testProgressLabel},null,8,["label"])])])),_:1},8,["value"]),(0,n.Wm)(T,{size:"30px",value:e.sentenceProgress,color:"accent",class:"q-mt-sm"},{default:(0,n.w5)((()=>[(0,n._)("div",d,[(0,n.Wm)(v,{color:"white","text-color":"accent",label:e.sentenceProgressLabel},null,8,["label"])])])),_:1},8,["value"])]),(0,n.Wm)(b,{flat:"",bordered:""},{default:(0,n.w5)((()=>[e.sentence&&e.sentence.length>0?((0,n.wg)(),(0,n.j4)(w,{key:0,style:{"font-size":"2em"},innerHTML:e.sentenceDisp},null,8,["innerHTML"])):(0,n.kq)("",!0)])),_:1}),e.startGameDelayCounter>=0?((0,n.wg)(),(0,n.iD)("div",h,[e.startGameDelayCounter>1?((0,n.wg)(),(0,n.iD)("div",u," Ready ")):(0,n.kq)("",!0),e.startGameDelayCounter>=0&&e.startGameDelayCounter<=1?((0,n.wg)(),(0,n.iD)("div",m," GO! ")):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])),e.isError?((0,n.wg)(),(0,n.iD)("div",p,y)):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(I,{class:"footer"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D,null,{default:(0,n.w5)((()=>["keydrop"==e.gamemode?((0,n.wg)(),(0,n.j4)(x,{key:0,ref:"keydropKeyboard",modelValue:e.text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.text=t),onKeypressed:t[1]||(t[1]=t=>e.logKey(t)),onWordpressed:t[2]||(t[2]=t=>e.logWord(t))},null,8,["modelValue"])):((0,n.wg)(),(0,n.j4)(k,{key:1,ref:"normalKeyboard",modelValue:e.text,"onUpdate:modelValue":t[3]||(t[3]=t=>e.text=t),onKeypressed:t[4]||(t[4]=t=>e.logKey(t)),onWordpressed:t[5]||(t[5]=t=>e.logWord(t))},null,8,["modelValue"]))])),_:1})])),_:1})])),_:1})])),_:1})}s(71),s(3985);var v=s(2837),T=s(9478);s(52);const w=(0,n.aZ)({name:"MainLayout",components:{KeydropKeyboard:v.Z,NormalKeyboard:T.Z},setup(){return{}},data(){return{text:"",startGameDelayCounter:3,startGameDelayInterval:void 0,refreshControlsInterval:void 0,sentenceIdx:-1,pressedKeys:[],completedSentences:[],gameFinished:!1,startTime:0,gameTimeStart:0,gameTimeStop:0,sentenceTimeStart:0,sentenceTimeStop:0,sentenceTimeElapsed:0,testTimeElapsed:0,sentence:void 0,gamemode:void 0}},computed:{viewportHeight:function(){return this.$q.screen.height-this.getFooterSize()},testProgressLabel:function(){return"Test progress: ðŸ•‘ "+this.testTimeDisp+"s | "+(this.sentenceIdx>-1?this.sentenceIdx:0)+"/"+this.sentences.length+" ("+(100*this.testProgress).toFixed(0)+"%)"},testProgress:function(){return this.sentenceIdx>-1?this.sentenceIdx/this.sentences.length:0},sentenceProgressLabel:function(){return"Round progress: ðŸ•‘ "+this.sentenceTimeDisp+"s | "+(100*this.sentenceProgress).toFixed(0)+"%"},sentenceProgress:function(){return this.sentence?this.correctCharacters()/this.sentence.length:0},testTimeDisp:function(){return this.testTimeElapsed?this.testTimeElapsed.toFixed(1):0},sentenceTimeDisp:function(){return this.sentenceTimeElapsed?this.sentenceTimeElapsed.toFixed(1):0},isError:function(){return this.correctCharacters()<this.text.length},sentenceDisp:function(){let e=this.sentence.toLowerCase(),t=this.text.toLowerCase(),s='<span style="color:black; background-color:lightgreen;">',n=this.correctCharacters();return s+=e.substr(0,n)+"</span>",n<t.length&&(s+='<span style="background-color:red">'+e.substr(n,t.length-n)+"</span>",n=t.length),s+='<span style="color:#aaa">'+e.substr(n,e.length-n)+"</span>",s}},deactivated(){},unmounted(){console.log("unmounted"),this.resetState()},created(){var e;this.gamemode=null!==(e=this.$route.params.mode)&&void 0!==e?e:"keydrop",this.sentences=["which form of transport do you prefer to use","every month i spend hundreds of dollars on gas insurance and repairs","an irrevocable letter of credit ensures that the seller gets paid in time","and since you are already a valued customer there should be no trouble in processing you application for this loan","would you prefer helping with the writing part or is programming more your thing","we could hire a car and travel around the interior of australia for several days","all of your coursework is important including everything from attendance and homework to all of your test results for the semester","it happened at the crossing just behind his house","your professor has placed this book on reserve","i make around one hundred thousand dollars per year"],this.startGameDelayCounter=3,this.gameFinished=!1,this.pressedKeys=[],this.sentenceIdx=-1,this.gameTimeStart=void 0,this.gameTimeStop=void 0,this.sentenceTimeStart=void 0,this.sentenceTimeStop=void 0,this.sentenceTimeElapsed=0,this.testTimeElapsed=0,this.completedSentences=[],this.refreshControlsInterval=setInterval((()=>{this.refreshControls()}),100),this.startGameDelayInterval=setInterval((()=>{this.startGameDelayCounter--,this.startGameDelayCounter<0&&(clearInterval(this.startGameDelayInterval),this.gameStart())}),1e3)},mounted(){},methods:{correctCharacters:function(){if(void 0==this.sentence||void 0==this.text)return 0;let e=this.sentence.toLowerCase(),t=this.text.toLowerCase(),s=0;while(e[s]==t[s]&&s<e.length&&s<t.length)s++;return s},resetKeyboard:function(){for(let e of[this.$refs.keyboard,this.$refs.keydropKeyboard,this.$refs.normalKeyboard])void 0!=e&&e.reset()},refreshControls:function(){this.sentenceTimeElapsed=(Date.now()-this.sentenceTimeStart)/1e3,this.testTimeElapsed=(Date.now()-this.gameTimeStart)/1e3},nextSentence:function(){this.sentenceIdx>-1&&(this.sentenceTimeStop=Date.now(),this.completedSentences.push({sentence:this.sentence,text:this.text,idx:this.sentenceIdx,startTime:this.sentenceTimeStart,endTime:this.sentenceTimeStop,pressedKeys:this.pressedKeys})),this.pressedKeys=[],this.sentenceTimeStop=void 0,this.sentenceTimeStart=void 0,this.resetKeyboard(),this.sentenceIdx<this.sentences.length-1?(this.sentenceIdx++,this.sentence=this.sentences[this.sentenceIdx],this.sentenceTimeStart=Date.now()):(this.gameFinished=!0,this.gameEnd())},logKey:function(e){this.pressedKeys.push({key:{key:e.key,label:e.label,original_key:e.original_key,original_label:e.original_label},expected_key:this.sentence[this.text.length-1],position:this.text.length-1,correct:!this.isError&&e.key==this.sentence[this.text.length-1],time:Date.now()}),this.text.toLowerCase()==this.sentence.toLowerCase()&&this.nextSentence()},logTestScore:function(){let e=localStorage.getItem("tests");e=void 0==e?[]:JSON.parse(e),e.push({mode:this.gamemode,startTime:this.gameTimeStart,endTime:this.gameTimeStop,sentences:Object.assign([],this.completedSentences)}),localStorage.setItem("tests",JSON.stringify(e)),this.gameTimeStart=void 0,this.gameTimeStop=void 0,this.completedSentences=void 0},resetState:function(){console.log("resetState"),clearInterval(this.refreshControlsInterval),clearInterval(this.startGameDelayInterval),this.gameFinished=!1},gameEnd:function(){console.log("gameEnd"),1==this.gameFinished&&(console.log("gameEnd inside if"),this.gameTimeStop=Date.now(),this.logTestScore(),setTimeout((()=>{this.resetState(),this.$router.push("/")}),2e3))},gameStart:function(){this.gameTimeStart=Date.now(),this.nextSentence()},getFooterSize:function(){return document.getElementsByClassName("q-footer")[0].getBoundingClientRect().height}}});var b=s(3066),S=s(2652),x=s(1598),k=s(9721),D=s(151),C=s(5589),I=s(1762),K=s(9570),E=s(3747),_=s(7518),q=s.n(_);w.render=f;const L=w;q()(w,"components",{QLayout:b.Z,QPageContainer:S.Z,QLinearProgress:x.Z,QBadge:k.Z,QCard:D.Z,QCardSection:C.Z,QFooter:I.Z,QToolbar:K.Z,QToolbarTitle:E.Z})}}]);